(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3bf9909c"],{"4b94":function(t,e,a){},6596:function(t,e,a){"use strict";var o=a("bc3a"),l=a.n(o),r=a("5c96"),s=l.a.create({baseURL:"http://199.166.1.182:8000/api"});s.interceptors.request.use((function(t){return t}),(function(t){return Promise.reject(t)})),s.interceptors.response.use((function(t){if("blob"===t.config.responseType)return t.data;var e=t.data;return e.code&&200!==e.code?(Object(r["Message"])({message:e.message||"Error",type:"error",duration:5e3}),Promise.reject(new Error(e.msg||"Error"))):e}),(function(t){return console.log("err"+t),Object(r["Message"])({message:t.message,type:"error",duration:5e3}),Promise.reject(t)}));var n=s;function c(t){return n({url:"/poc/",method:"get",params:t})}function i(t){return n({url:"/poc/",method:"post",data:t})}function p(t){return n({url:"/poc/"+t+"/",method:"delete"})}function u(){return n({url:"/poc/download/",method:"get",responseType:"blob"})}function d(t){return n({url:"/poc/upload/",method:"post",data:t})}a.d(e,"d",(function(){return c})),a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return p})),a.d(e,"c",(function(){return u})),a.d(e,"e",(function(){return d}))},"84f23":function(t,e,a){"use strict";var o=a("4b94"),l=a.n(o);l.a},aab6:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"poc-detail"},[a("div",{staticClass:"poc-detail-container"},[a("el-form",{ref:"poc",attrs:{"label-position":"right",rules:t.validate,model:t.poc}},[a("div",{staticClass:"poc-item"},[a("div",{staticClass:"poc-item-title"},[t._v("\n          基础信息\n        ")]),t._v(" "),a("div",{staticClass:"poc-item-content"},[a("el-row",{attrs:{type:"flex",justify:"space-around"}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"PoC ID：","label-width":"100px",prop:"poc_id"}},[a("el-input",{attrs:{maxlength:"20",placeholder:"输入PoC ID"},model:{value:t.poc.poc_id,callback:function(e){t.$set(t.poc,"poc_id",e)},expression:"poc.poc_id"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"PoC名称：","label-width":"100px",prop:"poc_name"}},[a("el-input",{attrs:{placeholder:"输入PoC名称"},model:{value:t.poc.poc_name,callback:function(e){t.$set(t.poc,"poc_name",e)},expression:"poc.poc_name"}})],1)],1)],1),t._v(" "),a("el-row",{attrs:{type:"flex",justify:"space-around"}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"关联漏洞：","label-width":"100px",prop:"vulnerability"}},[a("el-input",{attrs:{placeholder:"输入关联漏洞"},model:{value:t.poc.vulnerability,callback:function(e){t.$set(t.poc,"vulnerability",e)},expression:"poc.vulnerability"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"影响组件：","label-width":"100px",prop:"components"}},[a("el-input",{attrs:{maxlength:"20",placeholder:"输入影响组件"},model:{value:t.poc.components,callback:function(e){t.$set(t.poc,"components",e)},expression:"poc.components"}})],1)],1)],1),t._v(" "),a("el-row",{attrs:{type:"flex",justify:"space-around"}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"影响版本：","label-width":"100px",prop:"version"}},[a("el-input",{attrs:{maxlength:"20",placeholder:"输入影响版本"},model:{value:t.poc.version,callback:function(e){t.$set(t.poc,"version",e)},expression:"poc.version"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"PoC描述：","label-width":"100px",prop:"poc_desc"}},[a("el-input",{attrs:{placeholder:"输入PoC描述"},model:{value:t.poc.poc_desc,callback:function(e){t.$set(t.poc,"poc_desc",e)},expression:"poc.poc_desc"}})],1)],1)],1)],1)]),t._v(" "),a("el-divider"),t._v(" "),a("div",{staticClass:"poc-item"},[a("div",{staticClass:"poc-item-title"},[a("el-row",{attrs:{type:"flex",align:"middle",justify:"center"}},[a("el-col",{attrs:{span:6}},[t._v(" 详细信息 ")]),t._v(" "),a("el-col",{staticClass:"flex-ed",attrs:{span:16}},[a("el-button",{attrs:{icon:"el-icon-download"},on:{click:t.downLoadFile}},[t._v("\n                下载PoC编写指南")]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{icon:t.isUpload?"":"el-icon-upload"},on:{click:function(e){t.isUpload=!t.isUpload}}},[t._v("\n                "+t._s(t.isUpload?"取消":"上传PoC"))])],1),t._v(" "),a("el-col",{attrs:{span:2}})],1)],1),t._v(" "),a("transition",{attrs:{name:"breadcrumb",mode:"out-in"}},[t.isUpload?a("div",{staticClass:"poc-item-content"},[a("div",{staticClass:"poc-item"},[a("div",{staticClass:"poc-item-content"},[a("div",{staticClass:"poc-upload"},[a("div",{staticClass:"poc-upload-title"},[t._v("上传PoC文件:")]),t._v(" "),a("el-upload",{staticClass:"poc-upload-container",attrs:{"http-request":t.fileUpload,"show-file-list":!1,accept:".py,.zip",drag:"",action:"","auto-upload":!0}},[a("i",{staticClass:"el-icon-upload"}),t._v(" "),a("div",{staticClass:"el-upload__text"},[t._v("\n                      将文件拖到此处，或"),a("em",[t._v("点击上传")]),a("br"),t._v("\n                      摁住Ctrl可同时多选，支持上传Py格式文件，单个文件不能超过10MB"),a("br"),t._v("\n                      严禁上传包含色情、暴力、反动等相关违法信息的文件。\n                    ")])])],1)])]),t._v(" "),a("div",{staticClass:"flex-c"},[a("el-button",{staticClass:"poc-detail-btn",attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("提交")])],1)]):a("div",{staticClass:"poc-item-content"},[a("div",{staticClass:"poc-item"},[a("div",{staticClass:"poc-item-title"},[t._v("\n                请求构造部分\n              ")]),t._v(" "),a("div",{staticClass:"poc-item-content"},[a("el-row",{attrs:{type:"flex",justify:"space-around"}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"请求方式：","label-width":"100px",prop:"method"}},[a("el-select",{attrs:{placeholder:"请选择请求方式"},model:{value:t.poc.method,callback:function(e){t.$set(t.poc,"method",e)},expression:"poc.method"}},t._l(t.methods,(function(t,e){return a("el-option",{key:e,attrs:{label:t,value:t}})})),1)],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"路径：","label-width":"100px",prop:"path"}},[a("el-input",{attrs:{maxlength:"100",placeholder:"输入路径"},model:{value:t.poc.path,callback:function(e){t.$set(t.poc,"path",e)},expression:"poc.path"}})],1)],1)],1),t._v(" "),a("el-row",{attrs:{type:"flex",justify:"space-around"}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"请求头：","label-width":"100px",prop:"header"}},[a("el-input",{attrs:{rows:"5",type:"textarea",placeholder:"输入请求头"},model:{value:t.poc.header,callback:function(e){t.$set(t.poc,"header",e)},expression:"poc.header"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[t._l(t.poc.params,(function(e,o){return a("el-form-item",{key:o,attrs:{label:0==o?"参数：":"","label-width":"100px",prop:"attrs"}},[a("div",{staticClass:"flex-sa"},[a("el-input",{attrs:{placeholder:"输入key"},model:{value:e.key,callback:function(a){t.$set(e,"key",a)},expression:"item.key"}}),t._v("\n                          \n                        "),a("el-input",{attrs:{placeholder:"输入value"},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}),t._v("\n                          "),a("el-button",{attrs:{circle:"",icon:"el-icon-"+(0==o?"plus":"minus")},on:{click:function(a){return t.handleAttr(o,e)}}})],1)])})),t._v(" "),a("el-form-item",{attrs:{label:"cookie：","label-width":"100px",prop:"cookie"}},[a("el-input",{attrs:{placeholder:"输入cookie"},model:{value:t.poc.cookie,callback:function(e){t.$set(t.poc,"cookie",e)},expression:"poc.cookie"}})],1)],2)],1)],1)]),t._v(" "),a("div",{staticClass:"poc-item"},[a("div",{staticClass:"poc-item-title"},[t._v("\n                结果验证部分\n              ")]),t._v(" "),a("div",{staticClass:"poc-item-content"},[a("el-row",{attrs:{type:"flex",justify:"space-around"}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"返回状态码：","label-width":"100px",prop:"status_code"}},[a("el-input",{attrs:{placeholder:"输入返回状态码"},model:{value:t.poc.status_code,callback:function(e){t.$set(t.poc,"status_code",e)},expression:"poc.status_code"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"返回内容匹配字：","label-width":"160px",prop:"content"}},[a("el-input",{attrs:{placeholder:"输入返回内容匹配字"},model:{value:t.poc.content,callback:function(e){t.$set(t.poc,"content",e)},expression:"poc.content"}})],1)],1)],1)],1)]),t._v(" "),a("div",{staticClass:"flex-c"},[a("el-button",{staticClass:"poc-detail-btn",attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("提 交")])],1)])])],1)],1)],1)])},l=[],r=(a("ac6a"),{allIsFlag:function(t){return function(e,a,o){(0===a.length||/.*[a-zA-Z0-9一-龟]{1,}.*/.test(a))&&o(),o(new Error(t))}},allIsNumber:function(t){return function(e,a,o){0!==a.length&&/^[0-9]*$/.test(a)||o(),o(new Error(t))}},dirPath:function(t){return function(e,a,o){0!==a.length&&0!==a.indexOf("/")||o(),o(new Error(t))}},keyOrValue:function(t){return function(e,a,o){var l=!0;a.forEach((function(t){""!==t.key&&""!==t.value&&(/^[a-zA-Z0-9]*$/.test(t.key)&&/^[a-zA-Z0-9]*$/.test(t.value)||(l=!1))})),l?o():o(new Error(t))}}}),s=["GET","POST","HEAD","PUT","DELETE","OPTIONS","TRACE","CONNECT"],n=a("6596"),c={data:function(){var t=this;return{methods:s,isUpload:!1,poc:{poc_id:"",poc_name:"",vulnerability:"",components:"",version:"",poc_desc:"",method:"",path:"",header:"",cookie:"",params:[{key:"",value:""}],status_code:"",content:""},validate:{poc_id:[{validator:r.allIsFlag("请输入正确的PoC ID"),trigger:"blur"}],poc_name:[{required:!0,message:"请输入PoC名称",trigger:"blur"},{validator:r.allIsNumber("请输入正确的PoC名称"),trigger:"blur"},{validator:r.allIsFlag("请输入正确的PoC名称"),trigger:"blur"}],vulnerability:[{validator:r.allIsFlag("请输入正确的关联漏洞"),trigger:"blur"}],components:[{validator:r.allIsFlag("请输入正确的影响组件"),trigger:"blur"},{validator:r.allIsNumber("请输入正确的影响组件"),trigger:"blur"}],version:[{validator:r.allIsFlag("请输入正确的影响版本"),trigger:"blur"}],poc_desc:[{validator:r.allIsFlag("请输入正确的PoC描述"),trigger:"blur"},{validator:r.allIsNumber("请输入正确的PoC描述"),trigger:"blur"}],method:[{required:!0,message:"选择请求方式",trigger:"blur"}],path:[{validator:r.dirPath("请输入正确的目录"),trigger:"blur"}],header:[{validator:r.allIsFlag("请输入正确的请求头"),trigger:"blur"},{validator:r.allIsNumber("请输入正确的请求头"),trigger:"blur"}],params:[{validator:r.keyOrValue("请输入正确的参数名"),trigger:"blur"},{validator:r.keyOrValue("请输入正确的参数值"),trigger:"blur"}],status_code:[{validator:function(e,a,o){t.poc.content.length>0||a.length>0?o():o(new Error("请输入正确的返回状态码"))},trigger:"blur"}],content:[{validator:function(e,a,o){t.poc.status_code.length>0||a.length>0?o():o(new Error("请输入正确的返回状态码"))},trigger:"blur"}]}}},methods:{handleAttr:function(t,e){if(0===t)this.poc.params.push({key:"",value:""});else{var a=this.poc.params.indexOf(e);-1!==a&&this.poc.params.splice(a,1)}},handleSubmit:function(){var t=this;this.$refs.poc.validate((function(e){e&&Object(n["a"])(t.poc).then((function(e){console.log(e),t.$message({type:"success",message:"添加成功"}),t.$router.push("/poc")}))}))},downLoadFile:function(){Object(n["c"])().then((function(t){var e=document.createElement("a");e.download="PoC编写指南.doc",e.style.display="none";var a=new Blob([t]);e.href=URL.createObjectURL(a),document.body.appendChild(e),e.click(),document.body.removeChild(e)}))},fileUpload:function(t){var e=new FormData;e.append("file",t.file),Object(n["e"])(e).then((function(t){console.log(t)}))}}},i=c,p=(a("84f23"),a("2877")),u=Object(p["a"])(i,o,l,!1,null,null,null);e["default"]=u.exports}}]);