(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e855fff"],{"0d26":function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"base-info flex-dc"},[e("div",{staticClass:"flex-w",staticStyle:{width:"100%"}},[e("div",{staticClass:"info-item flex"},[e("p",{staticClass:"info-label"},[t._v("溯源编号")]),t._v(" "),e("p",{staticClass:"info-word"},[t._v(t._s(t.id))])]),t._v(" "),e("div",{staticClass:"info-item flex"},[e("p",{staticClass:"info-label"},[t._v("黑客IP")]),t._v(" "),e("p",{staticClass:"info-word"},[t._v(t._s(t.data.source_ip||""))])]),t._v(" "),e("div",{staticClass:"info-item flex"},[e("p",{staticClass:"info-label"},[t._v("攻击目标")]),t._v(" "),e("p",{staticClass:"info-word info-word-box"},[t._v("\n        "+t._s(t.data.attack_details.length>0?t.data.attack_details.reduce((function(t,a){return t+a.destination_ip+"|"}),"").slice(0,-1):"暂无")+"\n      ")])]),t._v(" "),e("div",{staticClass:"info-item flex "},[e("p",{staticClass:"info-label "},[t._v("攻击手法")]),t._v(" "),e("p",{staticClass:"info-word info-word-box"},[t._v("\n        "+t._s(t.data.attack_details.length>0?t.data.attack_details.reduce((function(t,a){return t+a.attack_type+"|"}),"").slice(0,-1):"暂无")+"\n      ")])]),t._v(" "),e("div",{staticClass:"info-item flex"},[e("p",{staticClass:"info-label"},[t._v("溯源成功率")]),t._v(" "),e("p",{staticClass:"info-word"},[t._v(t._s(100*t.data.trace_rate)+"%")])]),t._v(" "),e("div",{staticClass:"info-item flex"},[e("p",{staticClass:"info-label"},[t._v("状态")]),t._v(" "),e("p",{staticClass:"info-word"},[t._v("\n        "+t._s(0==t.data.fz_status?"待反制":1==t.data.fz_status?"正在反制":"已完成")+"\n      ")])]),t._v(" "),e("div",{staticClass:"info-item flex"},[e("p",{staticClass:"info-label"},[t._v("地理位置")]),t._v(" "),e("p",{staticClass:"info-word"},[t._v("\n        "+t._s(t.location.city+t.location.district||"暂无")+"\n      ")])]),t._v(" "),e("div",{staticClass:"info-item flex"},[e("p",{staticClass:"info-label"},[t._v("覆盖半径")]),t._v(" "),e("p",{staticClass:"info-word"},[t._v("\n        "+t._s(t.location.radius||"暂无")+"\n      ")])]),t._v(" "),e("div",{staticClass:"info-item flex"},[e("p",{staticClass:"info-label"},[t._v("经度")]),t._v(" "),e("p",{staticClass:"info-word"},[t._v("\n        "+t._s(t.location.lng||"暂无")+"\n      ")])]),t._v(" "),e("div",{staticClass:"info-item flex"},[e("p",{staticClass:"info-label"},[t._v("纬度")]),t._v(" "),e("p",{staticClass:"info-word"},[t._v("\n        "+t._s(t.location.lat||"暂无")+"\n      ")])])]),t._v(" "),e("div",{staticClass:"detail-map-container"},[e("div",{staticClass:"flex-ac",staticStyle:{width:"100%",height:"100%"}},[e("baidu-map",{staticStyle:{width:"100%",height:"100%"},attrs:{center:t.location,zoom:16}},[e("bm-navigation",{attrs:{anchor:"BMAP_ANCHOR_TOP_RIGHT"}}),t._v(" "),e("bm-marker",{attrs:{position:t.location,dragging:!0},on:{click:function(a){t.mapShow=!0}}},[e("bm-info-window",{attrs:{show:t.mapShow},on:{close:function(a){t.mapShow=!1},open:function(a){t.mapShow=!0}}},[t._v(t._s(t.location.address||"暂无"))])],1),t._v(" "),e("bm-circle",{attrs:{center:t.location,radius:t.location,"stroke-color":"blue","stroke-opacity":.5,"stroke-weight":2}})],1)],1)])])},n=[],s=(e("c5f6"),{props:{id:{type:[String,Number],default:0},data:{type:Object,default:function(){}}},data:function(){return{mapShow:!1}},computed:{location:function(){var t={city:"",district:"",lng:"",lat:"",radius:"",address:""},a=this.data.location;return a?Array.isArray(a.multiAreas)?a.multiAreas[0]||t:a.multiAreas:t}}}),o=s,r=e("2877"),l=Object(r["a"])(o,i,n,!1,null,null,null);a["a"]=l.exports},1864:function(t,a,e){"use strict";var i=e("842d"),n=e.n(i);n.a},"6d35":function(t,a,e){"use strict";e.d(a,"m",(function(){return n})),e.d(a,"a",(function(){return s})),e.d(a,"d",(function(){return o})),e.d(a,"e",(function(){return r})),e.d(a,"l",(function(){return l})),e.d(a,"j",(function(){return c})),e.d(a,"n",(function(){return d})),e.d(a,"h",(function(){return u})),e.d(a,"c",(function(){return p})),e.d(a,"k",(function(){return f})),e.d(a,"g",(function(){return g})),e.d(a,"f",(function(){return m})),e.d(a,"i",(function(){return v})),e.d(a,"b",(function(){return h}));var i=e("b775");function n(t){return Object(i["a"])({url:"/attack/",method:"get",params:t})}function s(t){return Object(i["a"])({url:"/attack/batch_create/",method:"post",data:t})}function o(t){return Object(i["a"])({url:"/attack/batch_del/",method:"delete",data:{ids:[t]}})}function r(t){return Object(i["a"])({url:"/attack/batch_del/",method:"delete",data:t})}function l(t){return Object(i["a"])({url:"/tracesource/start_scan/",method:"post",data:t})}function c(t){return Object(i["a"])({url:"/attack/"+t+"/",method:"get"})}function d(t,a){return Object(i["a"])({url:"/attack/"+a+"/",method:"put",data:t})}function u(t){return Object(i["a"])({url:"/detail_tag_info/",method:"get",params:t})}function p(t){return Object(i["a"])({url:"/assetMapping/",method:"get",params:t})}function f(t){return Object(i["a"])({url:"/assetMappingZeye/",method:"get",params:t})}function g(t){return Object(i["a"])({url:"/tracesource/fz_result/",method:"get",params:{source_ip:t}})}function m(t){return Object(i["a"])({url:"/detail_domain/",method:"get",params:t})}function v(t){return Object(i["a"])({url:"/attack/down_template/",method:"get",params:t})}function h(t){return Object(i["a"])({url:"/attack/upload/",method:"post",data:t})}},7206:function(t,a,e){"use strict";function i(t,a){return a.map((function(a,e){return t.map((function(t){return"index"===t?e+1:a[t]}))}))}e.d(a,"a",(function(){return i}))},"7d13":function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"asset-container"},[e("div",{staticClass:"tools flex flex-sb"},[e("el-button",{attrs:{type:"primary",icon:"el-icon-sort"},on:{click:t.changeAssetEngine}},[t._v("切换为"+t._s(t.assetIsFoFA?"ZoomEye（超时":"FOFA")+"\n    ")]),t._v(" "),e("el-button",{attrs:{icon:"el-icon-upload2"},on:{click:t.downloadAssetList}},[t._v("导出当前页结果")])],1),t._v(" "),e("c-table",{attrs:{"table-loading":t.tableloading,settings:t.tableConfig,columns:t.assetColumn,data:t.assetData},scopedSlots:t._u([{key:"operation",fn:function(a){var i=a.scope;return[e("a",{staticStyle:{color:"#53A1FF"},attrs:{href:"#"},on:{click:function(a){return t.visitWeb(i.row.host)}}},[t._v("\n        访问")])]}}])}),t._v(" "),e("el-pagination",{staticClass:"asset-pagination",attrs:{background:"","hide-on-single-page":!0,"page-sizes":[10,20,30,50],"page-size":t.assetPage.page_size,"current-page":t.assetPage.page,layout:"total,prev, pager, next,sizes",total:t.assetTotal},on:{"update:currentPage":function(a){return t.$set(t.assetPage,"page",a)},"update:current-page":function(a){return t.$set(t.assetPage,"page",a)},"size-change":t.assetSizeChange,"current-change":t.assetPageChange}})],1)},n=[],s=e("5530"),o=e("6d35"),r=e("7206"),l=e("ed08"),c={props:{data:{type:Object,default:function(){}}},data:function(){return{tableConfig:{loading:!1,fit:!0,"max-height":"340px","highlight-current-row":!0,style:"width: 100%;","row-class-name":"ctable","header-row-style":{"background-color":"#509EFF06"},"header-cell-style":{"background-color":"#509EFF10"}},assetColumn:[{label:"序号",type:"index","header-align":"center",align:"center"},{label:"HOST",property:"host","header-align":"center",align:"center"},{label:"标题",property:"title","header-align":"center",align:"center"},{label:"发现时间",property:"trace_rate","header-align":"center",align:"center"},{label:"服务",property:"server","header-align":"center",align:"center"},{label:"操作",setslot:{default:"operation"},"header-align":"center",align:"center"}],tableloading:!1,assetIsFoFA:!0,assetData:[],assetPage:{page:1,page_size:10},assetTotal:0}},created:function(){this.getassetlist()},methods:{visitWeb:function(t){Object(l["a"])(t)},changeAssetEngine:function(){this.assetIsFoFA=!this.assetIsFoFA,this.assetTotal=0,this.assetPage={page:1,page_size:10},this.getassetlist()},getassetlist:function(){var t=this;this.tableloading=!0,this.assetIsFoFA?Object(o["c"])(Object(s["a"])({query:'ip="'.concat(this.data.source_ip,'"')},this.assetPage)).then((function(a){a.data.error&&t.$message.error("查询资产列表失败"),t.assetTotal=a.data.count,t.assetData=a.data.results||[]})).finally((function(){t.tableloading=!1})):Object(o["k"])(Object(s["a"])({query:'ip:"'.concat(this.data.source_ip,'"')},this.assetPage)).then((function(t){console.log(t)})).finally((function(){t.tableloading=!1}))},assetPageChange:function(t){this.assetPage.page=t,this.getassetlist()},assetSizeChange:function(t){this.assetPage.page_size=t,this.getassetlist()},downloadAssetList:function(){var t=this;if(0===this.assetData.length)return this.$message.warning("暂无数据");Promise.all([e.e("chunk-e9e431b4"),e.e("chunk-53ec1ae2"),e.e("chunk-58293907")]).then(e.bind(null,"4bf8d")).then((function(a){var e=["index","host","title","mtime","server"],i=Object(r["a"])(e,t.assetData),n=["序号","HOST","标题","发现时间","服务"];a.export_json_to_excel({header:n,data:i,filename:t.data.source_ip+"_资产测绘",autoWidth:!0,bookType:"xlsx"})}))}}},d=c,u=e("2877"),p=Object(u["a"])(d,i,n,!1,null,null,null);a["a"]=p.exports},"842d":function(t,a,e){},8802:function(t,a,e){"use strict";var i=e("b47e"),n=e.n(i);n.a},a2eb:function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"result-container"},[e("div",{staticClass:"result-item"},[e("div",{staticClass:"result-title"},[t._v("端口扫描")]),t._v(" "),t.fzResult.scan_port.length>0?e("div",{staticClass:"result-content flex-w"},t._l(t.fzResult.scan_port[0].ports,(function(a,i){return e("div",{key:i},[e("div",{staticClass:" flex-ac port-protocal flex"},[e("div",{staticClass:"result-port flex-ac"},[t._v(t._s(a[0]))]),t._v(" "),e("div",{staticClass:"result-protocal flex-ac"},[t._v(t._s(a[1]))])])])})),0):t._e()])]),t._v(" "),e("div",{staticClass:"result-container"},[e("div",{staticClass:"result-item"},[e("div",{staticClass:"result-title"},[t._v("WEB服务识别")]),t._v(" "),t.fzResult.web_server.length>0?e("div",{staticClass:"result-content flex-w"},t._l(t.fzResult.web_server,(function(a,i){return e("div",{key:i},[a.site?e("div",{staticClass:"result-word flex-ac"},[t._v("\n            "+t._s(a.site)+"\n          ")]):t._e()])})),0):t._e()])]),t._v(" "),e("div",{staticClass:"result-container"},[e("div",{staticClass:"result-item"},[e("div",{staticClass:"result-title"},[t._v("目录爆破")]),t._v(" "),e("div",{staticClass:"result-content flex-w"},t._l(t.fzResult.directory_blast,(function(a,i){return e("div",{key:i,staticClass:" cursor-pointer",on:{click:function(e){return t.showJumpDialog(a)}}},[a?e("div",{staticClass:"result-word flex-ac"},[t._v("\n            "+t._s(a)+"\n          ")]):t._e()])})),0)])]),t._v(" "),e("div",{staticClass:"result-container"},[e("div",{staticClass:"result-item"},[e("div",{staticClass:"result-title"},[t._v("漏洞检测")]),t._v(" "),e("div",{staticClass:"result-content flex-w"},t._l(t.fzResult.vul,(function(a,i){return e("div",{key:i},[a.name?e("div",{staticClass:"result-word flex-ac"},[t._v("\n            "+t._s(a.name)+"\n          ")]):t._e()])})),0)])]),t._v(" "),e("div",{staticClass:"result-container"},[e("div",{staticClass:"result-item"},[e("div",{staticClass:"result-title"},[t._v("弱口令")]),t._v(" "),e("div",{staticClass:"result-content flex-w"},t._l(t.fzResult.weak_password,(function(a,i){return e("div",{key:i},[a.name?e("div",{staticClass:"result-word flex-ac"},[t._v("\n            "+t._s(a.name)+"\n          ")]):t._e()])})),0)])]),t._v(" "),e("el-dialog",{staticClass:"jump-dialog",attrs:{"close-on-click-modal":!1,"close-on-press-escape":!1,title:"访问",visible:t.jumpDialog,"append-to-body":"",width:"17%"},on:{"update:visible":function(a){t.jumpDialog=a}}},[t._v("\n    建议使用无痕浏览器访问\n    "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(a){return t.visitWeb(t.jumpItem)}}},[t._v(" 直接访问")]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.copyUrl}},[t._v(" 复制地址")])],1)])],1)},n=[],s=e("6d35"),o=e("ed08"),r={props:{data:{type:Object,default:function(){}}},data:function(){return{jumpDialog:!1,fzResult:{scan_port:[{ports:[]}],web_server:[{site:""}],directory_blast:[],vul:[{}],weak_password:[]},jumpItem:{url:"",title:""}}},created:function(){this.getFzResult()},methods:{visitWeb:function(t){Object(o["a"])(t)},getFzResult:function(){var t=this;Object(s["g"])(this.data.source_ip).then((function(a){t.fzResult=a.data}))},showJumpDialog:function(t){this.jumpItem=t,this.jumpDialog=!0},copyUrl:function(){var t=document.createElement("input");t.value=this.jumpItem,document.body.appendChild(t),t.select(),document.execCommand("Copy"),t.remove(),this.$message({message:"复制成功",type:"success"}),this.jumpDialog=!1}}},l=r,c=(e("1864"),e("2877")),d=Object(c["a"])(l,i,n,!1,null,null,null);a["a"]=d.exports},b47e:function(t,a,e){},ebfd9:function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"domain-container"},[e("div",{staticClass:"tools"},[e("el-button",{attrs:{icon:"el-icon-upload2"},on:{click:t.downLoadDomain}},[t._v("\n      导出全部结果")])],1),t._v(" "),t.domainData.length?e("c-table",{attrs:{"table-loading":t.tableloading,settings:t.tableConfig,columns:t.domainColumn,data:t.domainData}}):e("el-alert",{attrs:{title:"暂无数据","show-icon":"",closable:!1,type:"info"}}),t._v(" "),e("el-pagination",{staticClass:"domain-pagination",attrs:{background:"","hide-on-single-page":!0,"current-page":t.domainPage.page,layout:"prev, pager, next",total:t.domainPage.total},on:{"update:currentPage":function(a){return t.$set(t.domainPage,"page",a)},"update:current-page":function(a){return t.$set(t.domainPage,"page",a)},"current-change":t.formaterrDomain}})],1)},n=[],s=e("2909"),o=(e("7f7f"),e("c5f6"),e("6d35")),r=e("7206"),l={props:{id:{type:[String,Number],default:0},data:{type:Object,default:function(){}}},data:function(){return{domainColumn:[{label:"序号",type:"index",width:"40px","header-align":"center",align:"center"},{label:"反制域名",property:"domain",width:"200px","header-align":"center",align:"center"},{label:"网站标题",property:"title",width:"100px","show-overflow-tooltip":!0,"header-align":"center",align:"center"},{label:"备案类型",property:"nature",width:"80px","header-align":"center",align:"center"},{label:"备案名称",property:"name",width:"200px","header-align":"center",align:"center"},{label:"备案号",property:"icp",width:"240px","header-align":"center",align:"center"},{label:"注册人","min-width":"100px","show-overflow-tooltip":!0,property:"registrant",align:"center"},{label:"注册邮箱",property:"email",width:"180px","header-align":"center",align:"center"},{label:"注册商",property:"registrar",width:"180px","header-align":"center",align:"center"},{label:"注册时间",property:"registrationTime",width:"180px","header-align":"center",align:"center"},{label:"到期时间",property:"expirationTime",width:"180px","header-align":"center",align:"center"}],domainData:[],domainDatas:[],domainPage:{page:1,page_size:10},domainTotal:0}},methods:{getDomainList:function(){var t=this;this.tableloading=!0,Object(o["f"])({attack_id:this.id}).then((function(a){Array.isArray(a.data)&&0===a.data.length||(t.domainDatas=a.data.domain,t.domainPage.total=t.domainDatas.length,t.formaterrDomain(1))})).finally((function(){t.tableloading=!1}))},formaterrDomain:function(t){this.domainPage.page=t,this.domainData=[];for(var a=this.domainPage.page_size*(this.domainPage.page-1);a<(this.domainPage.page_size*this.domainPage.page>this.domainDatas.length?this.domainDatas.length:this.domainPage.page_size*this.domainPage.page);a++){var e={id:a+1,domain:this.domainDatas[a].domain,title:this.domainDatas[a].title,nature:this.domainDatas[a].icp.nature,name:this.domainDatas[a].icp.name,icp:this.domainDatas[a].icp.icp,registrant:this.domainDatas[a].whois.registrant,email:this.domainDatas[a].whois.registrantContactEmail,registrar:this.domainDatas[a].whois.sponsoringRegistrar,registrationTime:this.domainDatas[a].whois.registrationTime,expirationTime:this.domainDatas[a].whois.expirationTime};this.domainData.push(e)}},downLoadDomain:function(){var t=this;0!==this.domainData.length?Promise.all([e.e("chunk-e9e431b4"),e.e("chunk-53ec1ae2"),e.e("chunk-58293907")]).then(e.bind(null,"4bf8d")).then((function(a){var e=["index","domain","title","nature","name","icp","registrant","registrantContactEmail","sponsoringRegistrar","registrationTime","expirationTime"],i=Object(s["a"])(t.domainDatas).map((function(t){return{domain:t.domain,title:t.title,nature:t.icp.nature,name:t.icp.name,icp:t.icp.icp,registrant:t.whois.registrant,registrantContactEmail:t.whois.registrantContactEmail,sponsoringRegistrar:t.whois.sponsoringRegistrar,registrationTime:t.whois.registrationTime,expirationTime:t.whois.expirationTime}}));i=Object(r["a"])(e,i);var n=["序号","域名","标题","类型","名称","ICP","注册人","邮箱","注册商","注册时间","到期时间"];a.export_json_to_excel({header:n,data:i,filename:t.data.source_ip+"_域名检测",autoWidth:!0,bookType:"xlsx"})})):this.$message.warning("暂无数据")}}},c=l,d=(e("8802"),e("2877")),u=Object(d["a"])(c,i,n,!1,null,null,null);a["a"]=u.exports},fc3b:function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"menace-container"},[e("div",{staticClass:"menace-group"},[e("div",{staticClass:"menace-item"},[e("div",{staticClass:"menace-title"},[t._v("\n        威胁情报-微步\n        "),e("a",{staticClass:"jump-link",attrs:{target:"_blank",href:"https://x.threatbook.cn/v5/ip/"+t.data.source_ip}},[e("el-tag",{attrs:{type:"primary"}},[t._v("访问")])],1)]),t._v(" "),e("div",{staticClass:"menace-info flex-w"},[e("div",{staticClass:"info-item flex"},[e("p",{staticClass:"info-label"},[t._v("情报标签")]),t._v(" "),t.WeixieData.tag_info&&t.WeixieData.tag_info.is_malicious?e("p",{staticClass:"info-word",staticStyle:{color:"#FF6E69"}},[t._v("\n            恶意"),e("i",{staticClass:"el-icon-warning-outline"})]):e("p",{staticClass:"info-word",staticStyle:{color:"green"}},[t._v("\n            非危险\n          ")])]),t._v(" "),e("div",{staticClass:"info-item flex"},[e("p",{staticClass:"info-label"},[t._v("IP属性")]),t._v(" "),t.WeixieData.tag_info&&t.WeixieData.tag_info.judgments?e("div",{staticClass:"info-word-box"},t._l(t.WeixieData.tag_info.judgments,(function(a,i){return e("el-tag",{key:i,staticClass:"info-word flex-ac",attrs:{type:"danger",size:"small",effect:"plain"}},[t._v(t._s(a||"-"))])})),1):e("div",{staticClass:"info-word-box"},[e("el-tag",{staticClass:"flex-ac",attrs:{type:"info",size:"small",effect:"plain"}},[t._v("暂无")])],1)])])]),t._v(" "),e("div",{staticClass:"menace-item"},[e("div",{staticClass:"menace-title"},[t._v("\n        当前开放端口及服务-微步\n      ")]),t._v(" "),t.WeixieData.ports?e("div",{staticClass:"menace-info flex-w"},t._l(t.WeixieData.ports,(function(a,i){return e("el-tag",{key:i},[t._v("\n          "+t._s(a.port))])})),1):e("div",{staticClass:"menace-info flex-w"},[e("el-tag",[t._v(" 暂无")])],1)])])])},n=[],s=(e("c5f6"),e("6d35")),o={props:{id:{type:[String,Number],default:0},data:{type:Object,default:function(){}}},data:function(){return{WeixieData:{tag_info:{},ports:[]}}},created:function(){this.getWeixieData()},methods:{getWeixieData:function(){var t=this;Object(s["h"])({attack_id:this.id}).then((function(a){a.success?t.WeixieData=a.data:t.$message.error(a.message)}))}}},r=o,l=e("2877"),c=Object(l["a"])(r,i,n,!1,null,null,null);a["a"]=c.exports}}]);