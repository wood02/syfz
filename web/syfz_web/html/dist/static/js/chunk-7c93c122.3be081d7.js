(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7c93c122"],{8330:function(e,t,l){},9756:function(e,t,l){"use strict";l.r(t);var a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"server"},[l("div",{staticClass:"server-container"},[l("div",{staticClass:"server-table"},[l("c-table",{attrs:{settings:e.tableConfig,columns:e.tableColumns,data:e.tableData},scopedSlots:e._u([{key:"cpu",fn:function(t){var l=t.scope;return[e._v("\n          "+e._s(l.row.cpu_rate)+"%\n        ")]}},{key:"memory",fn:function(t){var l=t.scope;return[e._v("\n          "+e._s(l.row.mem_rate)+"%\n        ")]}},{key:"status",fn:function(t){var l=t.scope;return[e._v("\n          "+e._s(l.row.status)+"\n        ")]}}])}),e._v(" "),l("el-pagination",{attrs:{"hide-on-single-page":"","current-page":e.query.page,total:e.total},on:{"update:currentPage":function(t){return e.$set(e.query,"page",t)},"update:current-page":function(t){return e.$set(e.query,"page",t)},"current-change":e.handlePageChange}})],1)]),e._v(" "),l("el-dialog",{attrs:{"close-on-click-modal":!1,"close-on-press-escape":!1,width:"30%",title:e.isAdd?"新增服务器":"编辑服务器",visible:e.showDialog},on:{"update:visible":function(t){e.showDialog=t},closed:e.handleClosed}},[l("el-form",{ref:"serverRefs",attrs:{"hide-required-asterisk":"","label-position":"top",rules:e.serverRule,model:e.currentItem}},[l("el-form-item",{attrs:{label:"服务器类型:",prop:"server_type"}},[l("el-select",{staticStyle:{width:"100%"},attrs:{size:"medium",placeholder:"请选择服务器类型"},model:{value:e.currentItem.server_type,callback:function(t){e.$set(e.currentItem,"server_type",t)},expression:"currentItem.server_type"}},[l("el-option",{attrs:{label:"信息收集",value:"信息收集"}}),e._v(" "),l("el-option",{attrs:{label:"端口扫描",value:"端口扫描"}}),e._v(" "),l("el-option",{attrs:{label:"目录爆破",value:"目录爆破"}}),e._v(" "),l("el-option",{attrs:{label:"弱口令爆破",value:"弱口令爆破"}}),e._v(" "),l("el-option",{attrs:{label:"漏洞检测",value:"漏洞检测"}})],1)],1),e._v(" "),l("el-form-item",{attrs:{label:"内网IP:",prop:"local_ip"}},[l("el-input",{attrs:{placeholder:"请输入内网IP"},model:{value:e.currentItem.local_ip,callback:function(t){e.$set(e.currentItem,"local_ip",t)},expression:"currentItem.local_ip"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"公网IP:",prop:"public_ip"}},[l("el-input",{attrs:{placeholder:"请输入公网IP"},model:{value:e.currentItem.public_ip,callback:function(t){e.$set(e.currentItem,"public_ip",t)},expression:"currentItem.public_ip"}})],1)],1),e._v(" "),l("span",{staticClass:"dialog-footer-right",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.showDialog=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.handleCheck}},[e._v("确 定")])],1)],1),e._v(" "),l("el-dialog",{attrs:{"close-on-click-modal":!1,"close-on-press-escape":!1,title:"删除服务器",width:"20%",visible:e.delDialog},on:{"update:visible":function(t){e.delDialog=t}}},[l("div",{staticClass:"del-container"},[l("div",{staticClass:"del-icon"},[l("i",{staticClass:"el-icon-warning"})]),e._v(" "),l("div",{staticClass:"del-tips"},[l("p",{staticClass:"del-tips-title"},[e._v("是否确定删除服务器？")]),e._v(" "),l("p",{staticClass:"del-tips-content"},[e._v("删除后无法恢复，请谨慎操作！")])])]),e._v(" "),l("span",{staticClass:"dialog-footer-right",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.delDialog=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:e.submitDelet}},[e._v("确 定")])],1)])],1)},r=[],s=l("b775");function i(e){return Object(s["a"])({url:"/tracesource/ts_server/",method:"get",params:e})}function n(e){return Object(s["a"])({url:"/server/",method:"post",data:e})}function o(e){return Object(s["a"])({url:"/server/"+e.id+"/",method:"put",data:e})}function c(e){return Object(s["a"])({url:"/server/"+e+"/",method:"delete"})}var u={filters:{servers:function(e){return["信息收集","端口扫描","目录爆破","弱口令爆破","漏洞检测"][e-1]},status:function(e){return["连接失败","正常"][e-1]}},data:function(){return{isAdd:!0,showDialog:!1,delDialog:!1,delItemId:0,loading:!1,query:{page:1},currentItem:{server_type:"",local_ip:"",public_ip:""},tableData:[],tableConfig:{fit:!0,align:"center","highlight-current-row":!0,style:"width: 100%;","row-class-name":"ctable","header-row-style":{"background-color":"#509EFF06"},"header-cell-style":{"background-color":"#509EFF10"}},total:0,pages:{page:1},tableColumns:[{label:"序号",width:"80px",type:"index"},{label:"IP",property:"ip"},{label:"CPU(%)",setslot:{default:"cpu"}},{label:"内存(%)",setslot:{default:"memory"}},{label:"连通性",setslot:{default:"status"}}],serverRule:{local_ip:[{required:!0,message:"请输入内网IP",trigger:"blur"}],public_ip:[{required:!0,message:"请输入外网IP",trigger:"blur"}],server_type:[{required:!0,message:"请选择服务器类型",trigger:"blur"}]},Interval:null}},created:function(){this.getData(),this.checkInterval()},beforeDestroy:function(){this.checkInterval()},methods:{checkInterval:function(){var e=this;this.Interval?clearInterval(this.Interval):this.Interval=setInterval((function(){e.getData()}),3e4)},getData:function(){var e=this;this.loading=!0,i(this.query).then((function(t){e.total=t.count,e.tableData=t.results})).finally((function(){e.loading=!1}))},handleAdd:function(){this.isAdd=!0,this.showDialog=!0},handleEdit:function(e){this.isAdd=!1,this.currentItem=e,this.showDialog=!0},handleDelete:function(e){this.delItemId=e,this.delDialog=!0},handlePageChange:function(e){this.query.page=e,this.getData()},submitDelet:function(){var e=this;c(this.delItemId).then((function(t){200===t.code?(e.delDialog=!1,e.$message.success("删除成功"),e.getData()):e.$message.error(t.detail)}))},handleCheck:function(){var e=this;this.$refs.serverRefs.validate((function(t){t&&(e.loading=!0,e.isAdd?n(e.currentItem).then((function(t){200===t.code?(e.$message.success("添加成功"),e.getData(),e.showDialog=!1):e.$message.error(t.msg)})).finally((function(){e.loading=!1})):o({id:e.currentItem.id,server_type:e.currentItem.server_type,local_ip:e.currentItem.local_ip,public_ip:e.currentItem.public_ip}).then((function(t){200===t.code?(e.$message.success("修改成功"),e.getData(),e.showDialog=!1):e.$message.error(t.msg)})).finally((function(){e.loading=!1})))}))},handleClosed:function(){console.log("asdasdas"),this.$refs.serverRefs.resetFields(),this.currentItem={server_type:"",local_ip:"",public_ip:""},this.showDialog=!1}}},d=u,p=(l("e965"),l("2877")),v=Object(p["a"])(d,a,r,!1,null,null,null);t["default"]=v.exports},e965:function(e,t,l){"use strict";var a=l("8330"),r=l.n(a);r.a}}]);